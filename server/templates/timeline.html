{{define "timeline.html"}}
<div class="timeline">
  {{range .}}
    <div class="timeline-step">
      <h3>Step {{.StepID}} - {{.Title}}</h3>
      <ul>
        {{range .Substeps}}
          <li
            class="substep substep-{{.Status}}"
            style="--dept-color: {{.RoleColor}}; --dept-border: {{.RoleBorder}}"
          >
            <div class="substep-head">
              <span class="pill">{{.SubstepID}}</span>
              <span class="title">{{.Title}}</span>
              <span
                class="dept-badge"
                style="--dept-color: {{.RoleColor}}; --dept-border: {{.RoleBorder}}"
              >{{.RoleLabel}}</span>
              <span class="status">{{.Status}}</span>
            </div>
            <div class="substep-meta">
              <span class="role">role: {{.Role}}</span>
              {{if eq .Status "done"}}
                <span class="actor">by {{.DoneBy}} ({{.DoneRole}})</span>
                <span class="time">{{.DoneAt}}</span>
                {{if .FileURL}}
                  <span class="data">file: {{.FileName}}</span>
                  <a class="secondary" href="{{.FileURL}}">Download</a>
                  {{if .FileSHA256}}<span class="data">sha256: {{.FileSHA256}}</span>{{end}}
                {{else if .DisplayValue}}
                  <span class="data">value: {{.DisplayValue}}</span>
                {{end}}
              {{end}}
            </div>
          </li>
        {{end}}
      </ul>
    </div>
  {{end}}
</div>
{{end}}
