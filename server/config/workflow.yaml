workflow:
  name: "Gallium recycling notarization"
  description: "Track the recycling process of gallium from intake to refinement and notarization"
  steps:
    - id: "1"
      title: "Incoming intake"
      order: 1
      substeps:
        - id: "1.0"
          title: "Record formata"
          order: 0
          role: "dep1"
          inputKey: "qa"
          inputType: "formata"
          schema:
            type: "object"
            required: ["inspectorName", "result", "purityScore", "riskBand"]
            properties:
              inspectorName:
                type: "string"
                title: "Inspector name"
              testMethod:
                type: "string"
                title: "Test method"
                enum: ["xrf", "icp_ms", "wet_chemistry", "visual_only"]
              result:
                type: "string"
                title: "QA result"
                enum: ["pass", "conditional_pass", "rework", "reject"]
              riskBand:
                type: "string"
                title: "Risk band"
                enum: ["low", "medium", "high", "critical"]
              purityScore:
                type: "number"
                title: "Purity score (range 0-100)"
                minimum: 0
                maximum: 100
              confidenceLevel:
                type: "integer"
                title: "Confidence level (range 1-5)"
                minimum: 1
                maximum: 5
              notes:
                type: "string"
                title: "QA notes"
              evidenceFile:
                type: "string"
                format: "data-url"
                title: "Evidence file"
          uiSchema:
            "ui:options":
              order: ["inspectorName", "testMethod", "result", "riskBand", "purityScore", "confidenceLevel", "notes", "evidenceFile"]
            testMethod:
              "ui:options":
                help: "Select how QA validation was performed."
            riskBand:
              "ui:options":
                help: "Choose the risk classification for this batch."
            purityScore:
              "ui:components":
                numberWidget: "rangeWidget"
              "ui:options":
                help: "Numeric range value between 0 and 100."
            confidenceLevel:
              "ui:components":
                numberWidget: "rangeWidget"
              "ui:options":
                help: "Numeric range value between 1 and 5."
            notes:
              "ui:components":
                textWidget: "textareaWidget"
              "ui:options":
                help: "Write a detailed QA narrative and exceptions."
            evidenceFile:
              "ui:components":
                stringField: "fileField"
              "ui:options":
                help: "Upload QA evidence."
        - id: "1.1"
          title: "Record incoming gallium (kg)"
          order: 1
          role: "dep1"
          inputKey: "incomingKg"
          inputType: "number"
        - id: "1.2"
          title: "Attach batch ID"
          order: 2
          role: "dep1"
          inputKey: "batchId"
          inputType: "string"
        - id: "1.3"
          title: "Upload gallium certification"
          order: 3
          role: "dep1"
          inputKey: "Gallium certification"
          inputType: "file"
    - id: "2"
      title: "Refinement"
      order: 2
      substeps:
        - id: "2.1"
          title: "Record refined gallium output (kg)"
          order: 1
          role: "dep2"
          inputKey: "refinedKg"
          inputType: "number"
        - id: "2.2"
          title: "Record purity (%)"
          order: 2
          role: "dep2"
          inputKey: "purityPct"
          inputType: "number"
    - id: "3"
      title: "QA + Notarize"
      order: 3
      substeps:
        - id: "3.1"
          title: "QA sign-off"
          order: 1
          role: "dep3"
          inputKey: "qaChecklist"
          inputType: "formata"
          schema:
            type: "object"
            required: ["inspectorName", "result", "purityScore", "riskBand"]
            properties:
              inspectorName:
                type: "string"
                title: "Inspector name"
              testMethod:
                type: "string"
                title: "Test method"
                enum: ["xrf", "icp_ms", "wet_chemistry", "visual_only"]
              result:
                type: "string"
                title: "QA result"
                enum: ["pass", "conditional_pass", "rework", "reject"]
              riskBand:
                type: "string"
                title: "Risk band"
                enum: ["low", "medium", "high", "critical"]
              purityScore:
                type: "number"
                title: "Purity score (range 0-100)"
                minimum: 0
                maximum: 100
              confidenceLevel:
                type: "integer"
                title: "Confidence level (range 1-5)"
                minimum: 1
                maximum: 5
              notes:
                type: "string"
                title: "QA notes"
              evidenceFile:
                type: "string"
                format: "data-url"
                title: "Evidence file"
          uiSchema:
            "ui:options":
              order: ["inspectorName", "testMethod", "result", "riskBand", "purityScore", "confidenceLevel", "notes", "evidenceFile"]
            testMethod:
              "ui:options":
                help: "Select how QA validation was performed."
            riskBand:
              "ui:options":
                help: "Choose the risk classification for this batch."
            purityScore:
              "ui:components":
                numberWidget: "rangeWidget"
              "ui:options":
                help: "Numeric range value between 0 and 100."
            confidenceLevel:
              "ui:components":
                numberWidget: "rangeWidget"
              "ui:options":
                help: "Numeric range value between 1 and 5."
            notes:
              "ui:components":
                textWidget: "textareaWidget"
              "ui:options":
                help: "Write a detailed QA narrative and exceptions."
            evidenceFile:
              "ui:components":
                stringField: "fileField"
              "ui:options":
                help: "Upload QA evidence."
        - id: "3.2"
          title: "Finalize notarization"
          order: 2
          role: "dep3"
          inputKey: "finalHash"
          inputType: "string"

departments:
  - id: "dep1"
    name: "Company 1"
    color: "#d7e9f2"
    border: "#6e99b2"
  - id: "dep2"
    name: "Department 2"
    color: "#e0f1d9"
    border: "#7da36c"
  - id: "dep3"
    name: "Department 3"
    color: "#f5e3c9"
    border: "#c2945a"

users:
  - id: "u1"
    name: "User 1"
    departmentId: "dep1"
  - id: "u2"
    name: "User 2"
    departmentId: "dep2"
  - id: "u3"
    name: "User 3"
    departmentId: "dep3"

dpp:
  enabled: true
  gtin: "09506000134352"
  lotInputKey: "batchId"
  lotDefault: ""
  serialInputKey: ""
  serialStrategy: ""
  productName: "Recycled Gallium Batch"
  productDescription: "Gallium intake and refinement process with notarized checkpoints."
  ownerName: "Attesta Demo Operator"
